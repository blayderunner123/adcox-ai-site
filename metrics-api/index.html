<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Adcox.AI — Metrics API Test Console</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico"/>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/>
  <link rel="manifest" href="/favicon/manifest.json"/>
  <meta name="theme-color" content="#0a0a0a"/>

  <!-- Open Graph -->
  <meta property="og:title" content="Adcox.AI — Metrics API"/>
  <meta property="og:site_name" content="Adcox.AI"/>
  <meta property="og:url" content="https://www.adcox.ai/metrics-api/"/>
  <meta property="og:description" content="Test and monitor Adcox.AI’s Metrics API — send events and view real-time responses."/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="https://www.adcox.ai/favicon/og-preview.png"/>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://www.adcox.ai",
    "name": "Adcox.AI",
    "publisher": {
      "@type": "Person",
      "name": "Jonathan R. Adcox",
      "url": "https://www.adcox.ai",
      "sameAs": ["https://linkedin.com/in/blayderunner123","https://github.com/blayderunner123"]
    }
  }
  </script>

  <!-- Theme -->
  <style>
    :root{ --bg:#0f1724; --muted:#9aa7bf; --primary:#0d6efd; --success:#198754; --warning:#ffc107; --danger:#dc3545; }
    body{
      background:
        radial-gradient(1200px 600px at 10% 10%, rgba(125,211,252,.06), transparent 10%),
        linear-gradient(180deg, #071028 0%, var(--bg) 100%);
      color:#e6eef8;
    }
    .card{background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.15);border-radius:12px;}
    pre{white-space:pre-wrap;color:#cde6ff;}
    /* Chart canvases sized nicely inside cards */
    .chart-card canvas{width:100% !important;height:320px !important;}
  </style>
  <style>
    /* Normalize navbar links to the muted palette site-wide */
    .navbar-dark .navbar-nav .nav-link { color: rgba(255,255,255,.55); }
    .navbar-dark .navbar-nav .nav-link:hover,
    .navbar-dark .navbar-nav .nav-link:focus { color: rgba(255,255,255,.75); }
    .navbar-dark .navbar-nav .nav-link.active,
    .navbar-dark .navbar-nav .show > .nav-link { color: #fff; }
  </style>
</head>
<body>
  <!-- Full Navbar -->
  <nav class="navbar navbar-expand-md navbar-dark" style="background:rgba(0,0,0,.25)">
    <div class="container">
      <a class="navbar-brand fw-bold" href="/">
        <img src="/favicon/favicon-32x32.png" alt="" width="28" height="28" class="d-inline-block align-text-top">
        ADCOX.AI
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="nav" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
          <li class="nav-item"><a class="nav-link" href="/#resume">Résumé</a></li>
          <li class="nav-item"><a class="nav-link" href="/#work">Adventures</a></li>
          <li class="nav-item"><a class="nav-link" href="/#weekly">Weekly</a></li>
          <li class="nav-item"><a class="nav-link" href="/#contact">Contact</a></li>
          <li class="nav-item"><a class="nav-link" href="/ask-ai/">Ask AI</a></li>
          <li class="nav-item"><a class="nav-link" href="/qr-brand/">QR Maker</a></li>
          <li class="nav-item"><a class="nav-link active" aria-current="page" href="/metrics-api/">Metrics</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Active-link logic (kept exactly as yours) -->
  <script>
    (() => {
      const here = location.pathname.replace(/\/+$/, '') || '/';
      document.querySelectorAll('.navbar a.nav-link').forEach(a => {
        const href = a.getAttribute('href').replace(/\/+$/, '') || '/';
        if (href === here || (here === '/' && href.startsWith('/#'))) {
          a.classList.add('active');
          a.setAttribute('aria-current', 'page');
        } else {
          a.classList.remove('active');
          a.removeAttribute('aria-current');
        }
      });
    })();
  </script>

  <!-- Page Body -->
  <main class="container py-4">
    <header class="text-center mb-4">
      <div class="badge text-bg-info">Adcox.ai Utility</div>
      <h1 class="mt-2">Metrics API Console</h1>
      <p class="text-secondary mb-0">Send test events to your Appwrite Metrics Function and inspect JSON responses.</p>
    </header>

    <!-- API Console -->
    <div class="card p-3 mb-4">
      <form id="metrics-form" class="d-flex flex-wrap gap-2 align-items-center">
        <input id="event" class="form-control" placeholder="Event name (e.g., pageview)" value="pageview" style="max-width:18ch;">
        <input id="value" type="number" class="form-control" placeholder="Value" value="1" style="max-width:10ch;">
        <button id="send" type="submit" class="btn btn-outline-light">Send Event</button>
        <button id="ping" type="button" class="btn btn-outline-info">Ping (GET)</button>
      </form>
    </div>

    <h5>Response</h5>
    <pre id="output">– Waiting –</pre>

    <!-- Charts Section -->
    <section class="mt-5">
      <header class="d-flex align-items-center justify-content-between mb-3">
        <h2 class="h4 m-0">Charts</h2>
        <span class="text-secondary small">Demo data — will wire to API later</span>
      </header>

      <div class="row g-4">
        <!-- Bar -->
        <div class="col-lg-6">
          <div class="card chart-card">
            <div class="card-body">
              <h5 class="card-title mb-3">Visitors (Last 5 Days)</h5>
              <canvas id="barChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Donut -->
        <div class="col-lg-6">
          <div class="card chart-card">
            <div class="card-body">
              <h5 class="card-title mb-3">Device Share</h5>
              <canvas id="donutChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Bubble -->
        <div class="col-12">
          <div class="card chart-card">
            <div class="card-body">
              <h5 class="card-title mb-3">Engagement Bubbles</h5>
              <canvas id="bubbleChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  <footer class="py-4">
    <div class="container text-center muted small">
      © <strong>Jonathan R. Adcox</strong>, traces of humor included, commas preferred.
    </div>
  </footer>

  <!-- Metrics API Console Scripts -->
  <script>
    const endpoint = 'https://68e6787d002ae8594c92.nyc.appwrite.run/';
    const output = document.getElementById('output');
    const form = document.getElementById('metrics-form');
    const eventInput = document.getElementById('event');
    const valueInput = document.getElementById('value');
    const pingBtn = document.getElementById('ping');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      output.textContent = 'Sending...';
      try {
        const res = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            event: eventInput.value.trim() || 'pageview',
            value: Number(valueInput.value) || 1
          })
        });
        const json = await res.json();
        output.textContent = JSON.stringify(json, null, 2);
      } catch (err) {
        output.textContent = String(err);
      }
    });

    pingBtn.addEventListener('click', async () => {
      output.textContent = 'Pinging...';
      try {
        const res = await fetch(endpoint);
        const json = await res.json();
        output.textContent = JSON.stringify(json, null, 2);
      } catch (err) {
        output.textContent = String(err);
      }
    });
  </script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Match the dark theme using Bootstrap variables / current computed styles
    Chart.defaults.font.family = getComputedStyle(document.body).fontFamily;
    Chart.defaults.color = getComputedStyle(document.body).color;
    Chart.defaults.borderColor = 'rgba(255,255,255,.15)';
    // Subtle grid lines for dark mode
    const grid = { color: 'rgba(255,255,255,.08)' };

    // BAR
    const barCtx = document.getElementById('barChart');
    const barChart = new Chart(barCtx, {
      type: 'bar',
      data: {
        labels: ['Mon','Tue','Wed','Thu','Fri'],
        datasets: [{
          label: 'Visitors',
          data: [120,190,300,250,400],
          backgroundColor: 'rgba(13,110,253,.6)',    // primary-ish
          borderColor: 'rgba(13,110,253,1)',
          borderWidth: 1,
          borderRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { grid: { display:false } },
          y: { beginAtZero:true, ticks:{ stepSize:50 }, grid }
        },
        plugins: { legend: { display:false } }
      }
    });

    // DONUT
    const donutCtx = document.getElementById('donutChart');
    const donutChart = new Chart(donutCtx, {
      type: 'doughnut',
      data: {
        labels: ['Desktop','Mobile','Tablet'],
        datasets: [{
          data: [55,30,15],
          backgroundColor: [
            'rgba(13,110,253,.85)',  // primary
            'rgba(25,135,84,.85)',   // success
            'rgba(255,193,7,.85)'    // warning
          ],
          borderColor: 'rgba(0,0,0,0)'
        }]
      },
      options: {
        responsive:true,
        maintainAspectRatio:false,
        cutout:'60%',
        plugins:{ legend:{ position:'bottom', labels:{ color:'#cfd7e6' } } }
      }
    });

    // BUBBLE
    const bubbleCtx = document.getElementById('bubbleChart');
    const bubbleChart = new Chart(bubbleCtx, {
      type:'bubble',
      data:{
        datasets:[
          {
            label:'Homepage',
            data:[{x:1,y:4,r:12},{x:2,y:5,r:18},{x:3,y:3,r:10}],
            backgroundColor:'rgba(13,110,253,.6)'
          },
          {
            label:'QR Landing',
            data:[{x:1.5,y:3,r:16},{x:2.5,y:4.5,r:12},{x:3.2,y:5,r:20}],
            backgroundColor:'rgba(220,53,69,.6)'
          }
        ]
      },
      options:{
        responsive:true,
        maintainAspectRatio:false,
        scales:{
          x:{ title:{ display:true, text:'Session Depth' }, suggestedMin:0, suggestedMax:5, grid },
          y:{ title:{ display:true, text:'Avg Time on Page (min)' }, suggestedMin:0, suggestedMax:6, grid }
        },
        plugins:{ legend:{ position:'bottom', labels:{ color:'#cfd7e6' } } }
      }
    });
  </script>

  <!-- Bootstrap JS (bundle) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>