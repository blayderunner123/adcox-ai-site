<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Adcox.AI — Ask AI</title>

  <!-- Bootstrap 5 (CSS) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  />

  <!-- Prism.js syntax highlighting theme -->
  <link href="https://unpkg.com/prismjs/themes/prism-tomorrow.min.css" rel="stylesheet"/>

  <!-- Favicons -->
  <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico"/>
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/>
  <link rel="icon" type="image/png" sizes="48x48" href="/favicon/favicon-48x48.png"/>
  <link rel="icon" type="image/png" sizes="64x64" href="/favicon/favicon-64x64.png"/>
  <link rel="icon" type="image/png" sizes="128x128" href="/favicon/favicon-128x128.png"/>
  <link rel="icon" type="image/png" sizes="256x256" href="/favicon/favicon-256x256.png"/>
  <link rel="manifest" href="/favicon/manifest.json"/>
  <meta name="theme-color" content="#0a0a0a"/>

  <!-- Open Graph / preview -->
  <meta property="og:title" content="Adcox.AI — Ask AI"/>
  <meta property="og:site_name" content="Adcox.AI"/>
  <meta property="og:url" content="https://www.adcox.ai/ask-ai/"/>
  <meta property="og:description" content="Ask a question. The function does the talking; the browser keeps your secrets."/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="https://www.adcox.ai/favicon/og-preview.png"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://www.adcox.ai/favicon/og-preview.png"/>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "Person",
        "@id": "https://www.adcox.ai/#jr-adcox",
        "name": "Jonathan R. Adcox",
        "givenName": "Jonathan",
        "familyName": "Adcox",
        "url": "https://www.adcox.ai",
        "image": "https://www.adcox.ai/favicon/android-icon-192x192.png",
        "jobTitle": "Enterprise Applications Wrangler",
        "email": "mailto:jonathan.r.adcox@gmail.com",
        "worksFor": {
          "@type": "Organization",
          "name": "Soldier-up Designs",
          "url": "https://soldierupdesign.com"
        },
        "knowsAbout": [
          "PowerShell","Azure Logic Apps","Microsoft Graph","SharePoint (2010/2013/Online)",
          "Power BI","REST APIs","Process Automation","Systems Integration",
          "C#","ASP.NET / WebForms","Entity Framework","SQL Server","T-SQL",
          "HTML5","CSS3","JavaScript (ES5/ES6)","jQuery","Node.js","AngularJS",
          "WordPress","Joomla","Drupal","SFTP","RightFax","Concur","Multiview",
          "Lean Six Sigma","Knowledge Management"
        ],
        "sameAs": [
          "https://github.com/blayderunner123",
          "https://linkedin.com/in/blayderunner123",
          "https://soldierupdesign.com"
        ]
      },
      {
        "@type": "WebSite",
        "@id": "https://www.adcox.ai/#website",
        "url": "https://www.adcox.ai",
        "name": "Adcox.AI",
        "inLanguage": "en",
        "publisher": { "@id": "https://www.adcox.ai/#jr-adcox" }
      }
    ]
  }
  </script>

  <!-- Theme styles -->
  <style>
    :root{ --bg:#0f1724; --card:#0b1220; --muted:#9aa7bf; --accent:#7dd3fc; --teal:#14b8a6; }
    body{
      background: radial-gradient(1200px 600px at 10% 10%, rgba(125,211,252,.06), transparent 10%),
                  linear-gradient(180deg, #071028 0%, var(--bg) 100%);
      color:#e6eef8;
    }
    .hero-card{ background: rgba(255,255,255,0.06); backdrop-filter: blur(4px); border: 1px solid rgba(255,255,255,0.18); }
    .muted{ color:#d9e5ff; }
    .text-secondary{ color:#bcd1ff !important; }
    .section-title{ color:#eaf1ff; letter-spacing:.02em; }
    a.link-light, .navbar-dark .navbar-nav .nav-link{ color:#eaf1ff; }
    a.link-light:hover, .navbar-dark .navbar-nav .nav-link:hover{ color:#ffffff; }
    .btn-outline-light{ color:#eaf1ff; border-color:#cfe0ff; }
    .btn-outline-light:hover{ background:#cfe0ff; color:#0b1220; }
    .badge.text-bg-info{ color:#0b1220; }
    .wrap{ max-width:840px; margin:2rem auto; }
    .answer{ white-space:pre-wrap; line-height:1.45; }
    #answer{
      margin-top:12px; padding:14px 16px;
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
      border-radius:10px; color:#f1f5f9; line-height:1.5; min-height:48px;
    }
    #status{ display:block; margin-top:6px; font-size:.9rem; color:#9ca3af; }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-md navbar-dark" style="background:rgba(0,0,0,.25)">
    <div class="container">
      <a class="navbar-brand fw-bold" href="/">ADCOX.AI</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="nav" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
          <li class="nav-item"><a class="nav-link" href="/#resume">Résumé</a></li>
          <li class="nav-item"><a class="nav-link" href="/#work">Adventures</a></li>
          <li class="nav-item"><a class="nav-link" href="/#weekly">Weekly</a></li>
          <li class="nav-item"><a class="nav-link" href="/#contact">Contact</a></li>
          <li class="nav-item"><a class="nav-link active" aria-current="page" href="/ask-ai/">Ask AI</a>
          </li>
		  <li class="nav-item"><a class="nav-link" href="/qr-brand/">QR Maker</a></li>
		  <li class="nav-item"><a class="nav-link active" href="/metrics-api/">Metrics</a></li>
        </ul>
      </div>
    </div>
  </nav>
	<script>
		(() => {
		  const here = location.pathname.replace(/\/+$/, '') || '/';
		  document.querySelectorAll('.navbar a.nav-link').forEach(a => {
			const href = a.getAttribute('href').replace(/\/+$/, '') || '/';
			// exact match or section anchor on the home page
			if (href === here || (here === '/' && href.startsWith('/#'))) {
			  a.classList.add('active');
			  a.setAttribute('aria-current', 'page');
			} else {
			  a.classList.remove('active');
			  a.removeAttribute('aria-current');
			}
		  });
		})();
	</script>
  <main class="container py-4">
    <h1>Ask Adcox AI</h1>
    <p class="tagline">Ask anything — your browser keeps your secrets.</p>

    <form id="ask-form" class="toolbar d-flex gap-2 align-items-center flex-wrap">
      <input id="q" name="q" class="form-control" placeholder="Ask something..." style="max-width: 42ch;" />

      <label for="version" class="ms-2 me-1">Answer Style</label>
      <select id="version" name="version" class="form-select w-auto" title="Choose the backend mode">
        <option value="v1" data-endpoint="https://prompt-chatgpt.nyc.appwrite.run/">v1 — Concise</option>
        <option value="v2" data-endpoint="https://prompt-chatgpt.nyc.appwrite.run/" selected>v2 — Step-by-step</option>
        <option value="v3" data-endpoint="https://prompt-chatgpt.nyc.appwrite.run/">v3 — Detailed with code</option>
      </select>

      <button id="submit" type="submit" class="btn btn-outline-light">Ask</button>
    </form>

    <div id="status" aria-live="polite"></div>

    <div id="answer-wrap" class="mt-2">
      <div id="answer"></div>

      <!-- Meta row: latency + model/version badge -->
      <div id="meta" class="d-flex justify-content-between align-items-center mt-3" style="display:none;">
        <small id="latency" class="text-secondary"></small>
        <span id="model-badge" class="badge bg-info"></span>
      </div>
    </div>
  </main>

  <!-- DOMPurify, marked, Prism -->
  <script src="https://unpkg.com/dompurify@3.1.7/dist/purify.min.js"></script>
  <script src="https://unpkg.com/marked@12.0.2/marked.min.js"></script>
  <script src="https://unpkg.com/prismjs/prism.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-bash.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-powershell.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-json.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-javascript.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-typescript.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-markdown.min.js"></script>

  <script>
    const form = document.getElementById('ask-form');
    const input = document.getElementById('q');
    const statusEl = document.getElementById('status');
    const answerEl = document.getElementById('answer');
    const submitBtn = document.getElementById('submit');
    const versionEl = document.getElementById('version');
    const metaWrap = document.getElementById('meta');
    const latencyEl = document.getElementById('latency');
    const modelBadge = document.getElementById('model-badge');

    // Default endpoint + fallback version→model map (if header missing)
    let API_URL = 'https://prompt-chatgpt.nyc.appwrite.run/';
    const VERSION_TO_MODEL = { v1: 'gpt-4o-mini', v2: 'gpt-4o-mini', v3: 'gpt-4o-mini' };

    marked.setOptions({ breaks: true, gfm: true, headerIds: true });

    versionEl.addEventListener('change', () => {
      const opt = versionEl.selectedOptions[0];
      const ep = opt?.dataset?.endpoint;
      if (ep) API_URL = ep;
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const q = input.value.trim();
      if (!q) return;

      const selectedVersion = versionEl.value;

      submitBtn.disabled = true;
      statusEl.textContent = 'Thinking…';
      metaWrap.style.display = 'none';
      modelBadge.textContent = '';
      latencyEl.textContent = '';
      answerEl.innerHTML = '';

      try {
        const payload = { q, version: selectedVersion };

        const start = performance.now();
        const res = await fetch(API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'text/markdown'
          },
          body: JSON.stringify(payload)
        });
        const end = performance.now();
        const elapsed = ((end - start) / 1000).toFixed(2);

        if (!res.ok) {
          const txt = await res.text().catch(() => '');
          throw new Error(`HTTP ${res.status} — ${txt}`);
        }

        // Prefer server header; otherwise show fallback
        const headerModel = res.headers.get('x-model');
        const model = headerModel || VERSION_TO_MODEL[selectedVersion] || 'gpt-4o-mini';

        // Function returns Markdown
        const markdown = await res.text();
        const rawHtml = marked.parse(markdown);
        const safeHtml = DOMPurify.sanitize(rawHtml, { USE_PROFILES: { html: true } });
        answerEl.innerHTML = safeHtml;
        if (window.Prism) Prism.highlightAllUnder(answerEl);

        statusEl.textContent = 'Done.';
        latencyEl.textContent = `Done in ${elapsed}s.`;
        modelBadge.textContent = `${selectedVersion} – ${model}`;
        metaWrap.style.display = 'flex';

        answerEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
      } catch (err) {
        console.error(err);
        statusEl.textContent = 'Error fetching answer.';
        answerEl.innerHTML = `<pre>${DOMPurify.sanitize(String(err))}</pre>`;
      } finally {
        submitBtn.disabled = false;
      }
    });
  </script>
</body>
</html>